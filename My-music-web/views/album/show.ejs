<%- include("../partials/header.ejs") %>
<div class="container-fluid">
  <div class="p-1 p-md-3 mb-2 text-white rounded-3 albuminfo">
    <div class="col-md-6 px-0 d-flex">
      <img class="me-2 albuminfo--img" src="<%= album.image %>" width="140px" height="140px">
      <div class="d-block my-auto ms-1">
        <h3><%= album.name %></h3>
        <p class="lead mb-0">Artist : <a href="/artist/<%= album.artist._id %>" class="album--artistname"><%= album.artist.name %></a></p>
        <img src="/icon/blue_play.png" width="40px" height="40px">
      </div>
    </div>
  </div>
  <h3>Songs List</h3>
  <div class="my-2 p-3 rounded shadow-sm album-song" onpointerover="albumsongrowhover()">
    <% let i = 1;  %>
    <% song.forEach((song)=>{ %>
    <div class="d-flex pt-0 album-song-row">
      <p class="mt-3 me-3" id="number"><%=i++%></p>
      <div class="py-2 ps-2 mb-0 small lh-sm w-100">
        <div class="d-flex justify-content-between">
          <a href="/song/<%= song._id %>" class="text-white text-decoration-none mb-1"><strong
              class="album-song--name"><%= song.name %></strong></a>
        </div>
        <a class="d-inline text-white text-decoration-none" href="/artist/<%= song.artist._id %>"><span
            class="album-song--artistname"><%= song.artist.name %></span></a>
      </div>
      <% if(currentUser){ %> 
      <button type="button" class="my-auto bg-transparent border-0"><i class="fa-solid fa-play playbt--inrow"></i></button>
      <%if(Userfavsong.includes(song._id)){ %>
        <form action="/user/removefavsong/<%= song._id %>?_method=PUT" method="post" class="d-inline mx-2 my-auto">
          <button class="btn--unfav bg-transparent border-0">
            <i class="fa-solid fa-heart favbt--inrow"></i>
          </button>
        </form>
      <%} else { %>
      <form action="/user/addfavsong/<%= song._id %>" method="post" class="d-inline mx-2 my-auto">
        <button class="btn--fav bg-transparent border-0" href="/user/addfavsong/<%= song._id %>">
          <i class="fa-solid fa-heart favbt--inrow"></i>
        </button>
      </form>
      <%}%>
      <div class="btn-group dropup me-2">
        <button type="button" class="p-0 ms-1 btn--addplaylist " data-bs-toggle="dropdown" aria-expanded="false">
          <i class="fa-solid fa-plus addplaylist--inrow"></i>
        </button>
        <ul class="dropdown-menu dropdown-menu-dark bg-black">
          <% if(playlists){ %>
            <% playlists.forEach((playlist)=>{ %>
            <li>
              <form action="/playlist/<%= playlist._id %>/song/<%= song._id %>" method="post">
                <button class="dropdown-item" type="submit"><%= playlist.name %></button>
              </form>
              </li>
            <% }); %>
            <% } %>
          <li><hr class="dropdown-divider"></li>
          <li><a class="dropdown-item" href="#">Add to New Playlist</a></li>
        </ul>
      </div>
      <% } else { %>
        <button type="button" class="my-auto bg-transparent border-0" data-bs-toggle="modal" data-bs-target="#exampleModal">
            <i class="fa-solid fa-play playbt--inrow"></i>
          </button>
          <button type="button" class="btn--fav bg-transparent border-0 mx-2 my-auto" data-bs-toggle="modal" data-bs-target="#exampleModal">
            <i class="fa-solid fa-heart favbt--inrow"></i>
          </button>
          <button type="button" class="p-0 btn--addplaylist me-2" data-bs-toggle="modal" data-bs-target="#exampleModal">
            <i class="fa-solid fa-plus addplaylist--inrow"></i>
          </button>
          <%- include("../partials/login_modal.ejs") %>
   <% } %> 
    </div>
    <% }) %>
  </div>
</div>

<%- include("../partials/footer.ejs") %>